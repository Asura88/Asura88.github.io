/**
 * Share.js
 *
 * @author  overtrue <i@overtrue.me>
 * @license MIT
 *
 * @example
 * <pre>
 * $('.share-components').share();
 *
 * // or
 *
 * $('.share-bar').share({
 *     sites: ['qzone', 'qq', 'weibo','wechat'],
 *     // ...
 * });
 * </pre>
 */
(function(n){n.fn.share=function(t){function o(t,i){var r=h(i);(i.mode=="prepend"?r.reverse():r,r.length)&&n.each(r,function(r,u){var o=c(u,i),f=i.initialized?t.find(".icon-"+u):n('<a class="social-share-icon icon-'+u+'"><\/a>');if(!f.length)return!0;f.prop("aria-label","分享到 "+e[u]);f.prop("href",o);u==="wechat"?f.prop("tabindex",-1):f.prop("target","_blank");i.initialized||(i.mode=="prepend"?t.prepend(f):t.append(f))})}function s(n,t){var i=n.find("a.icon-wechat");i.length&&(i.append('<div class="wechat-qrcode"><h4>'+t.wechatQrcodeTitle+'<\/h4><div class="qrcode"><\/div><div class="help">'+t.wechatQrcodeHelper+"<\/div><\/div>"),i.find(".qrcode").qrcode({render:"image",size:t.wechatQrcodeSize,text:t.url}),i.offset().top<100&&i.find(".wechat-qrcode").addClass("bottom"))}function h(t){t.mobileSites.length===0&&t.sites.length&&(t.mobileSites=t.sites);var i=(a()?t.mobileSites:t.sites.length?t.sites:[]).slice(0),r=t.disabled;return typeof i=="string"&&(i=i.split(/\s*,\s*/)),typeof r=="string"&&(r=r.split(/\s*,\s*/)),l()&&r.push("wechat"),r.length&&n.each(r,function(t,r){var u=n.inArray(r,i);u!==-1&&i.splice(u,1)}),i}function c(n,t){var r=f[n],i,u,e;t.summary=t.description;for(i in t)t.hasOwnProperty(i)&&(u=n+i.replace(/^[a-z]/,function(n){return n.toUpperCase()}),e=encodeURIComponent(t[u]===undefined?t[i]:t[u]),r=r.replace(new RegExp("{{"+i.toUpperCase()+"}}","g"),e));return r}function l(){return/MicroMessenger/i.test(navigator.userAgent)}function a(){return n(window).width()<=768}var i=n(document.head),r={url:location.href,site_url:location.origin,source:i.find("[name=site], [name=Site]").attr("content")||document.title,title:i.find("[name=title], [name=Title]").attr("content")||document.title,description:i.find("[name=description], [name=Description]").attr("content")||"",image:n("article img").prop("src")||n("article img").prop("data-original")||"",imageSelector:undefined,weiboKey:"",wechatQrcodeTitle:"微信扫一扫：分享",wechatQrcodeHelper:"<p>微信里点“发现”，扫一下<\/p><p>二维码便可将本文分享至朋友圈。<\/p>",wechatQrcodeSize:100,mobileSites:[],sites:["weibo","qq","wechat","tencent","douban","qzone","linkedin","diandian","facebook","twitter","google"],disabled:[],initialized:!1},u=n.extend({},r,t),f={qzone:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url={{URL}}&title={{TITLE}}&desc={{DESCRIPTION}}&summary={{SUMMARY}}&site={{SOURCE}}",qq:"http://connect.qq.com/widget/shareqq/index.html?url={{URL}}&title={{TITLE}}&source={{SOURCE}}&desc={{DESCRIPTION}}&pics={{IMAGE}}",tencent:"http://share.v.t.qq.com/index.php?c=share&a=index&title={{TITLE}}&url={{URL}}&pic={{IMAGE}}",weibo:"https://service.weibo.com/share/share.php?url={{URL}}&title={{TITLE}}&pic={{IMAGE}}&appkey={{WEIBOKEY}}",wechat:"javascript:;",douban:"http://shuo.douban.com/!service/share?href={{URL}}&name={{TITLE}}&text={{DESCRIPTION}}&image={{IMAGE}}&starid=0&aid=0&style=11",diandian:"http://www.diandian.com/share?lo={{URL}}&ti={{TITLE}}&type=link",linkedin:"http://www.linkedin.com/shareArticle?mini=true&ro=true&title={{TITLE}}&url={{URL}}&summary={{SUMMARY}}&source={{SOURCE}}&armin=armin",facebook:"https://www.facebook.com/sharer/sharer.php?u={{URL}}&title={{TITLE}}&description={{DESCRIPTION}}&caption={{SUBHEAD}}&link={{URL}}&picture={{IMAGE}}",twitter:"https://twitter.com/intent/tweet?text={{TITLE}}&url={{URL}}&via={{SITE_URL}}",google:"https://plus.google.com/share?url={{URL}}"},e={qzone:"QQ空间",qq:"QQ",tencent:"腾讯微博",weibo:"微博",wechat:"微信",douban:"豆瓣",diandian:"点点",linkedin:"LinkedIn",facebook:"Facebook",twitter:"Twitter",google:"Google"};this.each(function(){var t,i;if(n(this).data("initialized"))return!0;t=n.extend({},u,n(this).data());t.imageSelector&&(t.image=n(t.imageSelector).map(function(){return n(this).prop("src")||n(this).prop("data-original")}).get().join("||"));i=n(this).addClass("share-component social-share");o(i,t);s(i,t);n(this).data("initialized",!0)})};n(function(){n(".share-component,.social-share").share()})})(jQuery);